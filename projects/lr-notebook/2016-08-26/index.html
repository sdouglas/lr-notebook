<!doctype html>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="icon" type="image/x-icon" href="../../../static/favicon.ico?h=e38ef9dd">
<link rel="stylesheet" href="../../../static/lib/normalize.css?h=ece571f3">
<link rel="stylesheet" href="../../../static/lib/skeleton.css?h=1fd77917">
<link rel="stylesheet" href="../../../static/style.css?h=5db9e889">
<link rel="stylesheet" href="../../../static/lib/medium-editor/medium-editor.min.css?h=17e98ac9">
<link rel="stylesheet" href="../../../static/fonts/anonymous-pro/anonymous-pro.css?h=7b3d4039">
<link rel="stylesheet" href="../../../static/fonts/fa/css/font-awesome.min.css?h=512c7d79">
<link rel="stylesheet" href="../../../static/fonts/ionicons/css/ionicons.min.css?h=f0459300">
<link rel="stylesheet" href="../../../static/fonts/source-sans-pro/source-sans-pro.css?h=eef2e813">

<!-- <script src="../../../static/lib/clipboard.min.js?h=64efc85d"></script> -->
<script src="../../../static/lib/jquery-2.2.1.min.js?h=7cb05e3d"></script>
<script src="../../../static/lib/marked.js?h=acaa528b"></script>
<script src="../../../static/lib/MooTools-Core-1.6.0.js?h=f829fe22"></script>
<script src="../../../static/lib/sprintf.js?h=f8d59971"></script>
<script src="../../../static/lib/medium-editor/medium-editor.min.js?h=d2c3e1bb"></script>
<script src="../../../static/lib/me-markdown.standalone.min.js?h=f8bd91a7"></script>
<script src="../../../static/lr-notebook.js?h=9fb07e66"></script>


<title></title>
<body>
  <header>
    <h1><i class="fa fa-sticky-note-o"></i> nb-sdouglas</h1>
    <nav>
      <ul class="nav navbar-nav">
        <li><a  href="../../../">Welcome</a></li>
        
          <li><a  class="active" href="../../../projects/">Projects</a></li>
        
          <li><a  href="../../../calendar/">Calendar</a></li>
        
          <li><a  href="../../../meetings/">Meetings</a></li>
        
          <li><a  href="../../../about/">About</a></li>
        
      </ul>
    </nav>
    
  </header>

  <iframe width="0" height="0" border="0" name="frame" style="border-style: none;"></iframe>

  <div class="page">
    
<h2 style="display: inline;"><a class="orange" href="../../../projects/lr-notebook/">lr-notebook/</a></h2><br>
<form target="frame" action="/admin/api/browsefs" method="post">
  <input type="hidden" name="path" value="/projects/lr-notebook/2016-08-26">
  <input type="image" src=../../../static/images/link.png>
</form>
<h2 class="lightblue" style="display: inline;">add clipboard.js to code blocks</h2> <span style="float:right;" class="midgray">2016-08-26</span> 
<hr>


<h5 style="float:left;">Attachments:</h5>


<div class="row">
  <div class="one column"></div>
  <div class="two columns"><!-- Attachments: --></div>
<div class="nine columns">
    
      
        <a href="../../../projects/lr-notebook/2016-08-26/001.gif"><img id="001.gif" draggable="true" ondragstart="drag(event)" ondragend="dragend(event)" src="../../../projects/lr-notebook/2016-08-26/001@50x50.gif"></a>
      
    
      
        <a href="../../../projects/lr-notebook/2016-08-26/002.gif"><img id="002.gif" draggable="true" ondragstart="drag(event)" ondragend="dragend(event)" src="../../../projects/lr-notebook/2016-08-26/002@50x50.gif"></a>
      
    
    <br/>
    
        <a class="green" href="../../../projects/lr-notebook/2016-08-26/001.mov">001.mov</a>
        
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
 
 
  
  
  
,
    
        <a class="green" href="../../../projects/lr-notebook/2016-08-26/002.mov">002.mov</a>
        
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
 
 
  
  
  
,
    
        <a class="green" href="../../../projects/lr-notebook/2016-08-26/clipboard.min.js">clipboard.min.js</a>
        
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
 
 
  
  
  

    
  </div>
</div>


<hr>






<div id="entry">
    <h1>Copy and Paste</h1>
<p>Adding a button for single-click copy to clipboard has been on the lr-notebook
project to-do list for a while.</p>
<h2>Example</h2>
<p>Here is an example code block. Click on the <i class="fa fa-files-o" aria-hidden="true"></i> button to its right, and the contents are sent to the clipboard. It selects the text as well, but note that you don't need to do an extra ctrl+c copy, it is already on the clipboard too.</p>
<div class="right">
  <a href="001.gif"><img class="thumb" src="001.gif"></a><br>
</div><pre><code>Lorem ipsum dolor sit amet,
consectetur adipisicing elit,
sed do eiusmod tempor incididunt
ut labore et dolore magna aliqua.
</code></pre>
<h2>How to add this to lr-notebook</h2>
<p>This is done using <a href="https://clipboardjs.com/">clipboardjs</a>.</p>
<p>First, copy the file clipboardjs.min.js into the <code>assets/static/js</code> folder and import the library on all pages by adding this line to <code>templates/layout.html</code></p>
<div class="right">
  [clipboard.min.js](clipboard.min.js) ‚Üê for convenience
</div><pre><code>&lt;script src="{{ '/static/js/clipboard.min.js'|asseturl }}"&gt;&lt;/script&gt;
</code></pre>
<p>Next, add this code to the bottom of <code>templates/entry.html</code> to create the buttons.</p>
<pre><code>&lt;script&gt;
var pre = document.getElementsByTagName('pre');
for (var i = 0; i &lt; pre.length; i++) {
  var button = document.createElement('button');
  button.className = 'btn fa fa-copy';
  pre[i].appendChild(button);
}

var clipboard = new Clipboard('.btn', {
  target: function(trigger) {return trigger.previousElementSibling;}
});

function showSuccess(elem){elem.setAttribute('class','btn fa fa-check');}
function sleep (time) {
  return new Promise((resolve) =&gt; setTimeout(resolve, time));
}
clipboard.on('success',function(e){
  showSuccess(e.trigger);
  sleep(350).then(() =&gt; {e.clearSelection();
    e.trigger.setAttribute('class','btn fa fa-copy');})
});
&lt;/script&gt;
</code></pre>
<p>This works by appending the button inside the end of every <code>pre</code> block. Nested inside the pre will be a <code>code</code> block where the actual content lives. The content becomes the Clipboard target as described in the "Advanced Usage" section of the <a href="https://clipboardjs.com/">project page</a>. The second half of the code (showSuccess onward) has to do with giving visual feedback about what text was successfully copied.</p>
<p>Finally, add the following to <code>assets/static/style.css</code> so the button is positioned and styled correctly. I added it around line 39.</p>
<pre><code>.btn {
  opacity:0.25;
  position:absolute;
  padding: 2px 2px;
  transition:opacity 0.3s ease-in-out;
  -webkit-transition:opacity 0.3s ease-in-out;-o-transition:opacity 0.3s ease-in-out;
}
.btn:hover{opacity:1;}
</code></pre>
<p>That's it! If you want the nifty tooltips that show up on the clipboardjs examples, those are done with <a href="http://primercss.io/tooltips/">primer-css tooltips</a>. I tried for a bit to add them here, but they break in conjunction with my css and I didn't want to spend the time needed to debug.</p>
<p>In the final version, I included the call to clipboard.on('success'...), which clears the selection and temporarily swaps out the copy icon. It required the mouseleave listener to be added to all btn buttons to reset the original class.</p>
<div class="right">
  <a href="002.gif"><img src="002.gif"></a><br>
</div>
</div>






<pre style="display:none;" class="markdown"></pre>

<script>
  function renderRightAsMarkdown() {
      var right = document.getElementsByClassName("right");
      for (var i=0; i<right.length; i++) {
          src = right[i].innerHTML
          right[i].innerHTML = marked(src);
      }
  }
  renderRightAsMarkdown();
</script>




<script>

// Disable clipboard stuff for now
// var pre = document.getElementsByTagName('pre');
// for (var i = 0; i < pre.length; i++) {
//   var button = document.createElement('button');
//   button.className = 'btn fa fa-copy';
//   pre[i].appendChild(button);
// }

// var clipboard = new Clipboard('.btn', {
//   target: function(trigger) {return trigger.previousElementSibling;}
// });

// function showSuccess(elem){elem.setAttribute('class','btn fa fa-check');}
// function sleep (time) {return new Promise((resolve) => setTimeout(resolve, time));}
// clipboard.on('success',function(e){
//   showSuccess(e.trigger);
//   sleep(350).then(() => {e.clearSelection();
//     e.trigger.setAttribute('class','btn fa fa-copy');})
// });

// Experimental direct editing

// var paragraphs = $$("#entry>p");
// var lastEl = paragraphs.getLast();
// var path = '/projects/lr-notebook/2016-08-26';

// paragraphs.each(function(el) {
//   var dropArea = new Element('div', {'class':'right droparea',
//                                      'ondrop':'drop(event, path)',
//                                      'ondragover':'dragover_handler(event)'
//                                      });
//   var next = el.getNext();
//   if (!!next && !next.hasClass('right')) {
//     droptext = new Element('div', {'id':'targetString',
//                                    styles:{display: 'none'},
//                                    'html':el.get('html')
//                                   });
//     droptext.inject(dropArea);
//     dropArea.inject(el, 'after');
//   }
// });

// var rightimgs = $$("img.thumb");
// rightimgs.each(function(el) {
//   var button = document.createElement('button');
//   button.className = 'btn fa fa-window-close';
//   el.appendChild(button);
// });

// var markDownEl = document.querySelector(".markdown");

// new MediumEditor($$("#entry>p"), {
//     extensions: {markdown: new MeMarkdown(function (md) {markDownEl.textContent = md;})},
//     toolbar: {
//       allowMultiParagraphSelection: false,
//       buttons: ['bold', 'italic', 'underline']
//     },
//     disableReturn: true,
//     disableDoubleReturn: true,
//     disableExtraSpaces: true,
//     paste: {
//         forcePlainText: true,
//         cleanPastedHTML: true
//     }
// });

</script>

<a href="slides" id="play-slides-link"><i class="fa fa-play" aria-hidden="true"></i></a>


  </div>

  <footer>
    &copy; 2016. Made with <a target="_new" href="http://bionano.ucsf.edu/"><i class="fa fa-cubes"></i></a> in SF.
  </footer>

</body>
